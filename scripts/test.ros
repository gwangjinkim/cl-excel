#!/bin/sh
#|-*- mode:lisp -*-|#
#|
exec ros -Q --- $0 "$@"
|#
(progn ;;init forms
  (ros:ensure-asdf)
  (push (uiop:getcwd) asdf:*central-registry*)
  #+quicklisp
  (progn
    (ignore-errors (ql:quickload :cl-tibble :silent t))
    (ql:quickload '(:cl-excel :cl-excel/tests) :silent t)))

(defpackage :ros.script.test.3693456789
  (:use :cl))
(in-package :ros.script.test.3693456789)

(defun main (&rest argv)
  (declare (ignore argv))
  (handler-case
      (let ((results (append (fiveam:run :cl-excel/test-suite)
                             (fiveam:run :cl-excel/refs)
                             (fiveam:run :cl-excel/workbook)
                             (fiveam:run :cl-excel/tables)
                             (fiveam:run :cl-excel/write-enhancements)
                             (fiveam:run :cl-excel/tibble)
                             (fiveam:run :cl-excel/compat))))
        (fiveam:explain! results)
        (if (fiveam:results-status results)
            (uiop:quit 0)
            (uiop:quit 1)))
    (error (c)
      (format *error-output* "~&Error: ~A~%" c)
      (uiop:quit 1))))
;;; vim: set ft=lisp lisp:
